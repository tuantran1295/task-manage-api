<!DOCTYPE html>
<html>
<head>
    <title>Register</title>
    <style>
        body { font-family: Arial; margin: 2em; }
        form { max-width: 350px; margin:auto; }
        input, select { width:100%; padding:8px; margin-top:0.3em;}
        button { margin-top:1em;}
        .error { color: red; }
    </style>
</head>
<body>
<h2>Register</h2>
<form id="register-form">
    <label>Name: <input name="name" required /></label>
    <label>Email: <input name="email" type="email" required /></label>
    <label>Password: <input name="password" type="password" required /></label>
    <label>Role:
        <select name="role" required>
            <option value="EMPLOYEE">Employee</option>
            <option value="EMPLOYER">Employer</option>
        </select>
    </label>
    <button type="submit">Register</button>
</form>
<div class="error" id="error"></div>
<p>Already have an account? <a href="/login">Login</a></p>
<script>
    document.getElementById('register-form').onsubmit = async function(e) {
        e.preventDefault();
        document.getElementById('error').textContent = "";
        const form = e.target;
        const body = {
            name: form.name.value,
            email: form.email.value,
            password: form.password.value,
            role: form.role.value
        };
        const res = await fetch('/api/auth/register', {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });
        if (res.ok) window.location = '/login';
        else {
            const err = await res.json();
            document.getElementById('error').textContent = err.message || "Registration failed";
        }
    };
</script>
</body>
</html>
